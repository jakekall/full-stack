(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{162:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(48),c=n.n(l),u=n(12),i=n(13),o=n(14),s=n(16),d=n(15),p=n(17),h=n(28),m=n(7),f=n.n(m),b=n(11),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFY":return t.message;case"CLEAR":return"";default:return e}},v=n(74),E=n(81),y=n(19),O=n.n(y),j="/api/blogs",w=null,k={setToken:function(e){w="bearer ".concat(e)},getAll:function(){return O.a.get(j).then(function(e){return e.data})},getOne:function(e){return O.a.get("".concat(j,"/").concat(e)).then(function(e){return e.data})},create:function(){var e=Object(b.a)(f.a.mark(function e(t){var n,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},e.next=3,O.a.post(j,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(b.a)(f.a.mark(function e(t,n){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.put("".concat(j,"/").concat(n),t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(b.a)(f.a.mark(function e(t){var n,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},e.next=3,O.a.delete("".concat(j,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return[].concat(Object(E.a)(e),[t.data]);case"LIKE_BLOG":var n=t.data.id,a=e.find(function(e){return e._id===n}),r=Object(v.a)({},a,{likes:a.likes+1});return e.map(function(e){return e._id!==n?e:r});case"DELETE_BLOG":return n=t.data.id,e.filter(function(e){return e._id!==n});default:return e}},S=n(164),B=n(165),C=n(172),_=n(166),L=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).handleFieldChange=function(e){n.setState(Object(h.a)({},e.target.name,e.target.value))},n.handleSubmit=function(e){e.preventDefault();var t={title:n.state.title,author:n.state.author,url:n.state.url};n.props.createNew(t),n.props.notify("You added '".concat(n.state.title,"'"),1e4),n.setState({title:"",author:"",url:""})},n.state={title:"",author:"",url:""},n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Create new blog"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(S.a,null,r.a.createElement(B.a,null,"title:"),r.a.createElement(C.a,{type:"text",name:"title",value:this.state.title,onChange:this.handleFieldChange}),r.a.createElement(B.a,null,"author:"),r.a.createElement(C.a,{type:"text",name:"author",value:this.state.author,onChange:this.handleFieldChange}),r.a.createElement(B.a,null,"url:"),r.a.createElement(C.a,{type:"text",name:"url",value:this.state.url,onChange:this.handleFieldChange}),r.a.createElement(_.a,{bsStyle:"success",type:"submit"},"create"))))}}]),t}(r.a.Component),I=Object(u.b)(null,{notify:function(e,t){return function(){var n=Object(b.a)(f.a.mark(function n(a){return f.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a({type:"NOTIFY",message:e}),setTimeout(function(){a({type:"CLEAR"})},t);case 2:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},createNew:function(e){return function(){var t=Object(b.a)(f.a.mark(function t(n){var a;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.create(e);case 2:a=t.sent,n({type:"NEW_BLOG",data:a});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}})(L),T={login:function(){var e=Object(b.a)(f.a.mark(function e(t){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":var n=t.data;return window.localStorage.setItem("loggedBloglistUser",JSON.stringify(n)),k.setToken(n.token),n;case"LOGOUT":return window.localStorage.removeItem("loggedBloglistUser"),null;case"LOGIN_WITH_TOKEN":var a=window.localStorage.getItem("loggedBloglistUser");if(!a)return null;var r=JSON.parse(a);return k.setToken(r.token),r;default:return e}},N=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).handleFieldChange=function(e){n.setState(Object(h.a)({},e.target.name,e.target.value))},n.handleSubmit=function(){var e=Object(b.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a={username:n.state.username,password:n.state.password},n.props.login(a),n.setState({username:"",password:""});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.state={username:"",password:""},n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(S.a,null,r.a.createElement(B.a,null,"username:"),r.a.createElement(C.a,{type:"text",name:"username",value:this.state.username,onChange:this.handleFieldChange}),r.a.createElement(B.a,null,"password:"),r.a.createElement(C.a,{type:"password",name:"password",value:this.state.password,onChange:this.handleFieldChange}),r.a.createElement(_.a,{bsStyle:"success",type:"submit"},"login"))))}}]),t}(r.a.Component),G=Object(u.b)(null,{login:function(e){return function(){var t=Object(b.a)(f.a.mark(function t(n){var a;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.login(e);case 2:a=t.sent,n({type:"LOGIN",data:a});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}})(N),F=n(174),A=Object(u.b)(function(e){return{notification:e.notification}})(function(e){var t=e.notification;return""===t?null:r.a.createElement(F.a,{bsStyle:"info"},r.a.createElement("div",null,t))}),z=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).toggleVisibility=function(){n.setState({visible:!n.state.visible})},n.state={visible:!1},n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e={display:this.state.visible?"none":""},t={display:this.state.visible?"":"none"};return r.a.createElement("div",null,r.a.createElement("div",{style:e},r.a.createElement(_.a,{bsStyle:"primary",onClick:this.toggleVisibility},this.props.buttonLabel)),r.a.createElement("div",{style:t},this.props.children,r.a.createElement(_.a,{onClick:this.toggleVisibility},"cancel")))}}]),t}(r.a.Component),D=n(144),V=n(167),W=n(143),R=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Blogs"),r.a.createElement(V.a,null,this.props.blogs.sort(function(e,t){return t.likes-e.likes}).map(function(e){return r.a.createElement(W.a,{key:e._id},r.a.createElement(D.a,{to:"/blogs/".concat(e._id)},e.title," by ",e.author))})))}}]),t}(r.a.Component),H=Object(u.b)(function(e){return{blogs:e.blogs}})(R),J=n(168),K=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Users"),r.a.createElement(J.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Blogs"))),r.a.createElement("tbody",null,this.props.users.map(function(e){return r.a.createElement("tr",{key:e._id},r.a.createElement("td",null,r.a.createElement(D.a,{to:"/users/".concat(e._id)},e.name)),r.a.createElement("td",null,e.blogs.length))}))))}}]),t}(r.a.Component),Y=Object(u.b)(function(e){return{users:e.users}})(K),M=n(169),q={margin:8},P={backgroundColor:"lightblue",padding:"10px 5px",borderBottomStyle:"solid"},Q={margin:8},X={fontWeight:"bold",color:"black"},Z=Object(u.b)(function(e){return{loggedUser:e.loggedUser}},{logout:function(){return function(e){e({type:"LOGOUT"})}}})(function(e){return r.a.createElement("div",{style:P},r.a.createElement(M.a,{exact:!0,to:"/",style:Q,activeStyle:X},"blogs"),r.a.createElement(M.a,{exact:!0,to:"/users",style:Q,activeStyle:X},"users"),r.a.createElement("em",{style:q},e.loggedUser.name," logged in"),r.a.createElement(_.a,{onClick:e.logout},"logout"))}),$=n(171),ee=function(e){var t=e.user;return r.a.createElement($.a,null,r.a.createElement($.a.Heading,null,r.a.createElement("h2",null,t.name)),r.a.createElement($.a.Body,null,r.a.createElement("h3",null,"Added blogs")),r.a.createElement(V.a,null,t.blogs.map(function(e){return r.a.createElement(W.a,{key:e._id},e.title," by ",e.author)})))},te=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleLikeButton=function(e){return function(){n.props.likeBlog(e)}},n.handleDeleteButton=function(e){return function(){window.confirm("delete '".concat(e.title,"' by ").concat(e.author))&&(n.props.removeBlog(e),n.props.history.push("/"))}},n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.blog;return r.a.createElement($.a,null,r.a.createElement($.a.Heading,null,r.a.createElement($.a.Title,{componentClass:"h2"},e.title)),r.a.createElement($.a.Body,null,r.a.createElement("a",{href:e.url},e.url),r.a.createElement("div",null,e.likes," ",r.a.createElement(_.a,{bsStyle:"success",bsSize:"small",onClick:this.handleLikeButton(e)},"like")),r.a.createElement("div",null,"added by ",e.user.name),this.props.loggedUser.name===e.user.name?r.a.createElement(_.a,{bsStyle:"danger",bsSize:"small",onClick:this.handleDeleteButton(e)},"delete"):null))}}]),t}(r.a.Component),ne=Object(u.b)(function(e){return{loggedUser:e.loggedUser}},{likeBlog:function(e){return function(){var t=Object(b.a)(f.a.mark(function t(n){var a;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={user:e.user,likes:e.likes+1,author:e.author,title:e.title,url:e.url},t.next=3,k.update(a,e._id);case 3:n({type:"LIKE_BLOG",data:{id:e._id}});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},removeBlog:function(e){return function(){var t=Object(b.a)(f.a.mark(function t(n){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.remove(e._id);case 2:n({type:"DELETE_BLOG",data:{id:e._id}});case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}})(te),ae=function(){return O.a.get("/api/users").then(function(e){return e.data})},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":case"GET_USER":return t.data;default:return e}},le=n(163),ce=n(173),ue=n(170),ie=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(l)))).findById=function(e,t){return e.find(function(e){return e._id===t})},n.appView=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z,null),r.a.createElement(le.a,{exact:!0,path:"/",render:function(){return r.a.createElement("div",null,r.a.createElement(z,{buttonLabel:"create new blog"},r.a.createElement(I,null)),r.a.createElement(H,null))}}),r.a.createElement(le.a,{exact:!0,path:"/users",render:function(){return r.a.createElement(Y,null)}}),r.a.createElement(le.a,{exact:!0,path:"/users/:id",render:function(e){var t=e.match;return r.a.createElement(ee,{user:n.findById(n.props.users,t.params.id)})}}),r.a.createElement(le.a,{exact:!0,path:"/blogs/:id",render:function(e){var t=e.match,a=e.history;return r.a.createElement(ne,{blog:n.findById(n.props.blogs,t.params.id),history:a})}}))},n.loginFormView=function(){return r.a.createElement(z,{buttonLabel:"login"},r.a.createElement(G,null))},n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.loginWithToken(),this.props.initializeBlogs(),this.props.initializeUsers()}},{key:"render",value:function(){return r.a.createElement(ce.a,null,r.a.createElement("div",{className:"container"},r.a.createElement(ue.a,null,"Blog App"),r.a.createElement(A,null),null===this.props.loggedUser?this.loginFormView():this.appView()))}}]),t}(r.a.Component),oe=Object(u.b)(function(e){return{loggedUser:e.loggedUser,blogs:e.blogs,users:e.users}},{initializeUsers:function(){return function(){var e=Object(b.a)(f.a.mark(function e(t){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},initializeBlogs:function(){return function(){var e=Object(b.a)(f.a.mark(function e(t){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},loginWithToken:function(){return function(e){e({type:"LOGIN_WITH_TOKEN"})}}})(ie),se=n(30),de=n(80),pe=Object(se.c)({notification:g,blogs:x,loggedUser:U,users:re}),he=Object(se.d)(pe,Object(se.a)(de.a)),me=function(){c.a.render(r.a.createElement(u.a,{store:he},r.a.createElement(oe,null)),document.getElementById("root"))};me(),he.subscribe(me)},82:function(e,t,n){e.exports=n(162)}},[[82,2,1]]]);
//# sourceMappingURL=main.73ff197c.chunk.js.map